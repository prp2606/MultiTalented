<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl"
      crossorigin="anonymous"
    />

    <link rel="shortcut icon" href="./public/Images/favicon.ico" type="image/x-icon" />

    <link rel="stylesheet" href="./public/styleSheets/guessGame.css" />

    <title>Multi-Talented</title>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg py-2 px-4 navbar-light bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand text-white" href="/MultiTalented/"
          ><h1>MT</h1></a
        >
        <button
          class="navbar-toggler bg-light"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNavDropdown"
          aria-controls="navbarNavDropdown"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
          <ul class="navbar-nav">
            <li class="nav-item ml-5" style="margin-left: 20px">
              <a
                class="nav-link text-white"
                aria-current="page"
                href="/MultiTalented/"
                >Home</a
              >
            </li>
            <li class="nav-item dropdown ml-5" style="margin-left: 20px">
              <a
                class="nav-link text-white dropdown-toggle active"
                href="#"
                id="navbarDropdownMenuLink"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Apps
              </a>
              <ul
                class="dropdown-menu"
                aria-labelledby="navbarDropdownMenuLink"
              >
                <li>
                  <a class="dropdown-item" href="/MultiTalented/calculator"
                    >Calculator</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>

                <li>
                  <a class="dropdown-item" href="/MultiTalented/notesTaker"
                    >Notes Taker</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a class="dropdown-item" href="/MultiTalented/expenseTracker"
                    >Expense Tracker</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a class="dropdown-item" href="/MultiTalented/todo"
                    >ToDo List Taker</a
                  >
                </li>
              </ul>
            </li>
            <li class="nav-item dropdown ml-5" style="margin-left: 20px">
              <a
                class="nav-link text-white dropdown-toggle"
                href="#"
                id="navbarDropdownMenuLink"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Games
              </a>
              <ul
                class="dropdown-menu"
                aria-labelledby="navbarDropdownMenuLink"
              >
                <li>
                  <a class="dropdown-item" href="/MultiTalented/guessGame"
                    >Guess Game</a
                  >
                </li>
                <li><hr class="dropdown-divider" /></li>
                <li>
                  <a class="dropdown-item" href="/MultiTalented/tictactoe"
                    >Tic Tac Toe</a
                  >
                </li>
              </ul>
            </li>
            <li class="nav-item dropdown ml-5" style="margin-left: 20px">
              <a
                class="nav-link text-white dropdown-toggle"
                href="#"
                id="navbarDropdownMenuLink"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Want to chat quickly with friends?
              </a>
              <ul
                class="dropdown-menu"
                aria-labelledby="navbarDropdownMenuLink"
              >
                <li>
                  <a
                    class="dropdown-item"
                    target="_blank"
                    href="https://weshare.netlify.app"
                    >WeShare</a
                  >
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="alert alert-info alert-dismissible fade show" role="alert">
      <strong>REFRESH</strong> to <strong>RESTART</strong> the game!
      <button
        type="button"
        class="btn-close"
        data-bs-dismiss="alert"
        aria-label="Close"
      ></button>
    </div>

    <h2 class="text-info text-center py-3">Guess Game</h2>

    <div class="container-fluid mainContainer h-75 bg-dark">
      <div class="row my-2" style="height: 250px">
        <div class="col-4">
          <div class="card" style="width: 100%; height: 100%">
            <div class="card-body front bg-info">
              <p class="card-text text-center">
                Guess me! Add a point to your score, I am on your luck &#128513;
              </p>
              <button class="btn btn-primary" onclick="flip()">Flip</button>
            </div>
            <div class="card-body back bg-warning"></div>
          </div>
        </div>
        <div class="col-4">
          <div class="card" style="width: 100%; height: 100%">
            <div class="card-body front bg-info">
              <p class="card-text text-center">
                I may be the reason behind your win &#128526;
              </p>
              <button class="btn btn-primary" onclick="flip()">Flip</button>
            </div>
            <div class="card-body back bg-warning"></div>
          </div>
        </div>
        <div class="col-4">
          <div class="card" style="width: 100%; height: 100%">
            <div class="card-body front bg-info">
              <p class="card-text text-center">
                Guess me bro! I've made great wins possible &#128521;
              </p>
              <button class="btn btn-primary" onclick="flip()">Flip</button>
            </div>
            <div class="card-body back bg-warning"></div>
          </div>
        </div>
      </div>
      <div class="row my-2" style="height: 250px">
        <div class="col-4">
          <div class="card" style="width: 100%; height: 100%">
            <div class="card-body front bg-info">
              <p class="card-text text-center">
                Any choice other than me will make you regret! &#128530;
              </p>
              <button class="btn btn-primary" onclick="flip()">Flip</button>
            </div>
            <div class="card-body back bg-warning"></div>
          </div>
        </div>
        <div class="col-4">
          <div class="card" style="width: 100%; height: 100%">
            <div class="card-body front bg-info">
              <p class="card-text text-center">
                Why are you thinking so much? Straight away hit my flip!
                &#128554;
              </p>
              <button class="btn btn-primary" onclick="flip()">Flip</button>
            </div>
            <div class="card-body back bg-warning"></div>
          </div>
        </div>
        <div class="col-4">
          <div class="card" style="width: 100%; height: 100%">
            <div class="card-body front bg-info">
              <p class="card-text text-center">
                Ignoring me? Be ready to add a point in your failed attempts
                &#128548;
              </p>
              <button class="btn btn-primary" onclick="flip()">Flip</button>
            </div>
            <div class="card-body back bg-warning"></div>
          </div>
        </div>
      </div>
    </div>

    <div
      class="container-fluid mainContainer bg-dark row text-light"
      style="padding: 10px 5px; margin: 20px auto"
    >
      <div class="col-6 text-center">
        <h3>
          Score
          <hr />
        </h3>
        <h4 class="text-center" id="score">0</h4>
      </div>
      <div class="col-6 text-center">
        <h3>
          Failed Attempt
          <hr />
        </h3>
        <h4 class="text-center" id="failedAttempt">0</h4>
      </div>
    </div>

    <script>
      let array = [];
      let mainArray = [];
      let decider = 0;
      let firstAttempt = "";
      let firstAttemptFront = "";
      let firstAttemptBack = "";
      let secondAttempt = "";
      let secondAttemptFront = "";
      let secondAttemptBack = "";
      let score = 0;
      let failedAttempt = 0;

      const initialStateSetter = () => {
        firstAttemptFront.style.animationName = "flipOver3";
        firstAttemptBack.style.animationName = "flipOver4";
        secondAttemptFront.style.animationName = "flipOver3";
        secondAttemptBack.style.animationName = "flipOver4";
      };

      const checker = () => {
        if (firstAttempt === secondAttempt) {
          score++;

          setTimeout(() => {
            alert("YAYYY! Matching piece found");
          }, 1000);
        } else {
          failedAttempt++;
          setTimeout(() => {
            alert("OOPSSS! Better luck next time");
          }, 1000);
        }

        let scoreContainer = document.getElementById("score");
        let failedAttemptContainer = document.getElementById("failedAttempt");

        scoreContainer.innerText = score;
        failedAttemptContainer.innerText = failedAttempt;

        firstAttempt = "";
        secondAttempt = "";
      };

      const flip = () => {
        const front = event.srcElement.parentElement;
        const parentsParent = event.srcElement.parentElement.parentElement;
        const back = Array.from(parentsParent.children);

        front.style.animationName = "flipOver1";
        back[1].style.animationName = "flipOver2";

        front.style.animationPlayState = "running";
        back[1].style.animationPlayState = "running";

        decider++;

        if (decider % 2 != 0) {
          firstAttempt = back[1].innerText;
          firstAttemptFront = front;
          firstAttemptBack = back[1];
        } else {
          secondAttempt = back[1].innerText;
          secondAttemptFront = front;
          secondAttemptBack = back[1];
          checker();

          setTimeout(randomizeHelper, 4000);
          setTimeout(initialStateSetter, 2000);
        }
      };

      const randomizer = () => {
        array = [];
        while (array.length < 3) {
          let key = Math.floor(Math.random() * (3 - 1 + 1) + 1);

          if (
            !array.find(function () {
              for (let i = 0; i < array.length; i++) {
                if (array[i] == key) {
                  return true;
                }
              }
              return false;
            })
          ) {
            array.push(key);
          }
        }
      };

      const randomizeHelper = () => {
        randomizer();
        mainArray = [];
        for (let i = 0; i < array.length; i++) {
          mainArray.push(array[i]);
        }

        randomizer();
        for (let i = 0; i < array.length; i++) {
          mainArray.push(array[i]);
        }

        const backCards = Array.from(document.getElementsByClassName("back"));

        let j = 0;

        backCards.forEach((element) => {
          element.innerText = mainArray[j];
          j++;
        });
      };

      window.onload = () => {
        randomizeHelper();
      };
    </script>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"
      crossorigin="anonymous"
    ></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.6.0/dist/umd/popper.min.js" integrity="sha384-KsvD1yqQ1/1+IA7gi3P0tyJcT3vR+NdBTt13hSJ2lnve8agRGXTTyNaBYmCR/Nwi" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.min.js" integrity="sha384-nsg8ua9HAw1y0W1btsyWgBklPnCUAFLuTMS2G72MMONqmOymq585AcH49TLBQObG" crossorigin="anonymous"></script>
    -->
  </body>
</html>
